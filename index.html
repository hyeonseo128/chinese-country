<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ì¤‘êµ­ì–´ ë°œìŒ ì—°ìŠµ í”„ë¡œê·¸ë¨</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/tailwindcss/2.2.19/tailwind.min.js"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/tailwindcss/2.2.19/tailwind.min.css" rel="stylesheet">
    <style>
        body {
            background: linear-gradient(135deg, #fef2f2 0%, #fef3c7 100%);
            min-height: 100vh;
        }
    </style>
</head>
<body class="p-4">
    <div class="max-w-2xl mx-auto">
        <div class="bg-white rounded-xl shadow-lg p-6 mb-6">
            <div class="text-center mb-6">
                <h1 class="text-3xl font-bold text-red-600 mb-2">ğŸ‡¨ğŸ‡³ ì¤‘êµ­ì–´ ë°œìŒ ì—°ìŠµ</h1>
                <p class="text-gray-600">êµ­ê°€ëª… í•œì–´ë³‘ìŒê³¼ ëœ»ì„ ë§ì¶°ë³´ì„¸ìš”!</p>
            </div>

            <div class="flex justify-between items-center mb-6 p-4 bg-gray-50 rounded-lg">
                <div class="text-sm text-gray-600">
                    ë¼ìš´ë“œ <span id="round">1</span> â€¢ ì§„í–‰ë¥ : <span id="progress">0</span>/<span id="total">24</span>
                </div>
                <div class="text-sm">
                    ì •ë‹µë¥ : <span id="accuracy">0</span>% (<span id="correct">0</span>/<span id="attempts">0</span>)
                </div>
            </div>

            <div class="text-center mb-8">
                <div class="mb-4">
                    <button id="playBtn" class="bg-red-500 hover:bg-red-600 text-white px-8 py-4 rounded-lg text-xl font-bold flex items-center gap-3 mx-auto transition-colors">
                        ğŸ”Š ë°œìŒ ë“£ê¸°
                    </button>
                </div>
                <p class="text-gray-500 text-sm">ë²„íŠ¼ì„ í´ë¦­í•˜ì—¬ ì¤‘êµ­ì–´ ë°œìŒì„ ë“¤ì–´ë³´ì„¸ìš”</p>
            </div>

            <div class="space-y-6">
                <!-- í•œì–´ë³‘ìŒ ì…ë ¥ -->
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">
                        í•œì–´ë³‘ìŒ (ë¡œë§ˆì, ë„ì–´ì“°ê¸° ìƒê´€ì—†ìŒ)
                    </label>
                    <input 
                        type="text" 
                        id="pinyinInput"
                        class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-transparent"
                        placeholder="ì˜ˆ: hÃ¡n guÃ³ ë˜ëŠ” hÃ¡nguÃ³"
                    />
                </div>

                <!-- ì„±ì¡° ì„ íƒ -->
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">
                        ì„±ì¡° ì¶”ê°€ (ë§ˆì§€ë§‰ ì•ŒíŒŒë²³ì— ì„±ì¡° í‘œì‹œ)
                    </label>
                    <div class="flex gap-2 mb-3">
                        <button onclick="addTone(1)" class="px-4 py-2 bg-blue-500 hover:bg-blue-600 text-white rounded-lg font-bold transition-colors">
                            1ì„± Ë‰
                        </button>
                        <button onclick="addTone(2)" class="px-4 py-2 bg-blue-500 hover:bg-blue-600 text-white rounded-lg font-bold transition-colors">
                            2ì„± ËŠ
                        </button>
                        <button onclick="addTone(3)" class="px-4 py-2 bg-blue-500 hover:bg-blue-600 text-white rounded-lg font-bold transition-colors">
                            3ì„± Ë‡
                        </button>
                        <button onclick="addTone(4)" class="px-4 py-2 bg-blue-500 hover:bg-blue-600 text-white rounded-lg font-bold transition-colors">
                            4ì„± Ë‹
                        </button>
                        <button onclick="removeTone()" class="px-4 py-2 bg-gray-500 hover:bg-gray-600 text-white rounded-lg transition-colors">
                            ì„±ì¡° ì œê±°
                        </button>
                    </div>
                    <div class="text-sm text-gray-600">
                        ì˜ˆì‹œ: "han guo" ë˜ëŠ” "hanguo" ì…ë ¥ í›„ ê°ê° ì„±ì¡° ë²„íŠ¼ í´ë¦­ â†’ "hÃ¡n guÃ³" ë˜ëŠ” "hÃ¡nguÃ³"
                    </div>
                </div>

                <!-- ëœ» ì…ë ¥ -->
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">
                        ëœ» (í•œêµ­ì–´)
                    </label>
                    <input 
                        type="text" 
                        id="meaningInput"
                        class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-transparent"
                        placeholder="ì˜ˆ: í•œêµ­"
                    />
                </div>

                <!-- ê²°ê³¼ í‘œì‹œ -->
                <div id="result" class="hidden p-4 rounded-lg">
                    <div class="flex items-center gap-2 mb-3">
                        <span id="resultIcon"></span>
                        <span id="resultText" class="font-bold"></span>
                    </div>
                    
                    <div class="space-y-2 text-sm">
                        <div>
                            <strong>ì •ë‹µ:</strong>
                            <div class="ml-4">
                                <div>í•œì: <span id="correctChinese"></span></div>
                                <div>ë³‘ìŒ: <span id="correctPinyin"></span></div>
                                <div>ëœ»: <span id="correctMeaning"></span></div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- ë²„íŠ¼ë“¤ -->
                <div class="flex gap-3">
                    <button id="checkBtn" onclick="checkAnswer()" class="flex-1 bg-green-500 hover:bg-green-600 text-white py-3 rounded-lg font-bold transition-colors">
                        ì •ë‹µ í™•ì¸
                    </button>
                    <button id="nextBtn" onclick="nextQuestion()" class="flex-1 bg-blue-500 hover:bg-blue-600 text-white py-3 rounded-lg font-bold transition-colors hidden">
                        ë‹¤ìŒ ë¬¸ì œ
                    </button>
                    
                    <button onclick="location.reload()" class="px-6 bg-gray-500 hover:bg-gray-600 text-white py-3 rounded-lg transition-colors">
                        ğŸ”„
                    </button>
                </div>
            </div>
        </div>

        <div class="text-center text-sm text-gray-500">
            ğŸ’¡ íŒ: ë³‘ìŒì„ ì…ë ¥í•œ í›„ ì„±ì¡° ë²„íŠ¼ì„ ëˆŒëŸ¬ ë§ˆì§€ë§‰ ê¸€ìì— ì„±ì¡°ë¥¼ ì¶”ê°€í•˜ì„¸ìš”. ë„ì–´ì“°ê¸°ëŠ” ììœ ë¡­ê²Œ í•˜ì„¸ìš”.
        </div>
    </div>

    <script>
        const countryData = [
            { korean: 'í•œêµ­', chinese: 'éŸ©å›½', pinyin: 'hÃ¡n guÃ³', meaning: 'í•œêµ­' },
            { korean: 'ì¼ë³¸', chinese: 'æ—¥æœ¬', pinyin: 'rÃ¬ bÄ›n', meaning: 'ì¼ë³¸' },
            { korean: 'ì¤‘êµ­', chinese: 'ä¸­å›½', pinyin: 'zhÅng guÃ³', meaning: 'ì¤‘êµ­' },
            { korean: 'ì¸ë„', chinese: 'å°åº¦', pinyin: 'yÃ¬n dÃ¹', meaning: 'ì¸ë„' },
            { korean: 'ì‹±ê°€í¬ë¥´', chinese: 'æ–°åŠ å¡', pinyin: 'xÄ«n jiÄ pÅ', meaning: 'ì‹±ê°€í¬ë¥´' },
            { korean: 'ë¯¸êµ­', chinese: 'ç¾å›½', pinyin: 'mÄ›i guÃ³', meaning: 'ë¯¸êµ­' },
            { korean: 'ìºë‚˜ë‹¤', chinese: 'åŠ æ‹¿å¤§', pinyin: 'jiÄ nÃ¡ dÃ ', meaning: 'ìºë‚˜ë‹¤' },
            { korean: 'ë¸Œë¼ì§ˆ', chinese: 'å·´è¥¿', pinyin: 'bÄ xÄ«', meaning: 'ë¸Œë¼ì§ˆ' },
            { korean: 'ì•„ë¥´í—¨í‹°ë‚˜', chinese: 'é˜¿æ ¹å»·', pinyin: 'Ä gÄ“n tÃ­ng', meaning: 'ì•„ë¥´í—¨í‹°ë‚˜' },
            { korean: 'ì¹ ë ˆ', chinese: 'æ™ºåˆ©', pinyin: 'zhÃ¬ lÃ¬', meaning: 'ì¹ ë ˆ' },
            { korean: 'ì˜¤ìŠ¤íŠ¸ë ˆì¼ë¦¬ì•„', chinese: 'æ¾³å¤§åˆ©äºš', pinyin: 'Ã o dÃ  lÃ¬ yÃ ', meaning: 'ì˜¤ìŠ¤íŠ¸ë ˆì¼ë¦¬ì•„' },
            { korean: 'ë‰´ì§ˆëœë“œ', chinese: 'æ–°è¥¿å…°', pinyin: 'xÄ«n xÄ« lÃ¡n', meaning: 'ë‰´ì§ˆëœë“œ' },
            { korean: 'ì˜êµ­', chinese: 'è‹±å›½', pinyin: 'yÄ«ng guÃ³', meaning: 'ì˜êµ­' },
            { korean: 'í”„ë‘ìŠ¤', chinese: 'æ³•å›½', pinyin: 'fÇ guÃ³', meaning: 'í”„ë‘ìŠ¤' },
            { korean: 'ìŠ¤í˜ì¸', chinese: 'è¥¿ç­ç‰™', pinyin: 'xÄ« bÄn yÃ¡', meaning: 'ìŠ¤í˜ì¸' },
            { korean: 'ëŸ¬ì‹œì•„', chinese: 'ä¿„ç½—æ–¯', pinyin: 'Ã© luÃ³ sÄ«', meaning: 'ëŸ¬ì‹œì•„' },
            { korean: 'ë…ì¼', chinese: 'å¾·å›½', pinyin: 'dÃ© guÃ³', meaning: 'ë…ì¼' },
            { korean: 'ì´íƒˆë¦¬ì•„', chinese: 'æ„å¤§åˆ©', pinyin: 'yÃ¬ dÃ  lÃ¬', meaning: 'ì´íƒˆë¦¬ì•„' },
            { korean: 'ìŠ¤ì›¨ë´', chinese: 'ç‘å…¸', pinyin: 'ruÃ¬ diÇn', meaning: 'ìŠ¤ì›¨ë´' },
            { korean: 'ë²¨ê¸°ì—', chinese: 'æ¯”åˆ©æ—¶', pinyin: 'bÇ lÃ¬ shÃ­', meaning: 'ë²¨ê¸°ì—' },
            { korean: 'ì´ì§‘íŠ¸', chinese: 'åŸƒåŠ', pinyin: 'Äi jÃ­', meaning: 'ì´ì§‘íŠ¸' },
            { korean: 'ë‚¨ì•„í”„ë¦¬ì¹´ê³µí™”êµ­', chinese: 'å—éå…±å’Œå›½', pinyin: 'nÃ¡n fÄ“i gÃ²ng hÃ© guÃ³', meaning: 'ë‚¨ì•„í”„ë¦¬ì¹´ê³µí™”êµ­' },
            { korean: 'ì¼€ëƒ', chinese: 'è‚¯å°¼äºš', pinyin: 'kÄ›n nÃ­ yÃ ', meaning: 'ì¼€ëƒ' },
            { korean: 'ë‚˜ì´ì§€ë¦¬ì•„', chinese: 'å°¼æ—¥åˆ©äºš', pinyin: 'nÃ­ rÃ¬ lÃ¬ yÃ ', meaning: 'ë‚˜ì´ì§€ë¦¬ì•„' }
        ];

        let currentIndex = 0;
        let shuffledIndices = [];
        let usedIndices = new Set();
        let score = { correct: 0, total: 0 };
        let round = 1;

        // ì„±ì¡° ë§¤í•‘
        const toneMap = {
            'a': ['Ä', 'Ã¡', 'Ç', 'Ã '],
            'e': ['Ä“', 'Ã©', 'Ä›', 'Ã¨'],
            'i': ['Ä«', 'Ã­', 'Ç', 'Ã¬'],
            'o': ['Å', 'Ã³', 'Ç’', 'Ã²'],
            'u': ['Å«', 'Ãº', 'Ç”', 'Ã¹'],
            'Ã¼': ['Ç–', 'Ç˜', 'Çš', 'Çœ'],
            'v': ['Ç–', 'Ç˜', 'Çš', 'Çœ']
        };

        // ì…”í”Œ í•¨ìˆ˜
        function shuffleArray(array) {
            const shuffled = [...array];
            for (let i = shuffled.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [shuffled[i], shuffled[j]] = [shuffled[j], shuffled[i]];
            }
            return shuffled;
        }

        // ì´ˆê¸°í™”
        function init() {
            const indices = Array.from({ length: countryData.length }, (_, i) => i);
            shuffledIndices = shuffleArray(indices);
            updateUI();
        }

        // UI ì—…ë°ì´íŠ¸
        function updateUI() {
            const progress = usedIndices.size;
            document.getElementById('round').textContent = round;
            document.getElementById('progress').textContent = progress;
            document.getElementById('total').textContent = countryData.length;
            document.getElementById('correct').textContent = score.correct;
            document.getElementById('attempts').textContent = score.total;
            document.getElementById('accuracy').textContent = score.total > 0 ? Math.round((score.correct / score.total) * 100) : 0;
        }

        // í˜„ì¬ ë‹¨ì–´ ê°€ì ¸ì˜¤ê¸°
        function getCurrentWord() {
            return countryData[shuffledIndices[currentIndex]];
        }

        // TTS í•¨ìˆ˜
        function speakChinese() {
            if ('speechSynthesis' in window) {
                window.speechSynthesis.cancel();
                const utterance = new SpeechSynthesisUtterance(getCurrentWord().chinese);
                utterance.lang = 'zh-CN';
                utterance.rate = 0.8;
                utterance.pitch = 1;
                window.speechSynthesis.speak(utterance);
            }
        }

        // ì„±ì¡° ì¶”ê°€
        function addTone(tone) {
            const input = document.getElementById('pinyinInput');
            const text = input.value;
            if (!text) return;
            
            const lastChar = text.slice(-1).toLowerCase();
            if (toneMap[lastChar]) {
                const newText = text.slice(0, -1) + toneMap[lastChar][tone - 1];
                input.value = newText;
            }
        }

        // ì„±ì¡° ì œê±°
        function removeTone() {
            const input = document.getElementById('pinyinInput');
            const text = input.value;
            if (!text) return;
            
            const lastChar = text.slice(-1);
            const toneChars = 'ÄÃ¡ÇÃ Ä“Ã©Ä›Ã¨Ä«Ã­ÇÃ¬ÅÃ³Ç’Ã²Å«ÃºÇ”Ã¹Ç–Ç˜ÇšÇœ';
            const baseChars = 'aaaaeeeeiiiioooouuuuÃ¼Ã¼Ã¼Ã¼';
            
            const toneIndex = toneChars.indexOf(lastChar);
            if (toneIndex !== -1) {
                const baseChar = baseChars[toneIndex];
                input.value = text.slice(0, -1) + baseChar;
            }
        }

        // ì •ë‹µ í™•ì¸
        function checkAnswer() {
            const userPinyin = document.getElementById('pinyinInput').value.toLowerCase().replace(/\s+/g, '');
            const userMeaning = document.getElementById('meaningInput').value.trim();
            
            const currentWord = getCurrentWord();
            const correctPinyin = currentWord.pinyin.toLowerCase().replace(/\s+/g, '');
            const correctMeaning = currentWord.meaning;

            const pinyinCorrect = correctPinyin === userPinyin;
            const meaningCorrect = correctMeaning === userMeaning;
            const allCorrect = pinyinCorrect && meaningCorrect;
            
            // ì ìˆ˜ ì—…ë°ì´íŠ¸
            if (allCorrect) score.correct++;
            score.total++;
            
            // ê²°ê³¼ í‘œì‹œ
            const resultDiv = document.getElementById('result');
            const resultIcon = document.getElementById('resultIcon');
            const resultText = document.getElementById('resultText');
            
            if (allCorrect) {
                resultDiv.className = 'p-4 rounded-lg bg-green-50 border border-green-200';
                resultIcon.textContent = 'âœ“';
                resultIcon.className = 'text-green-600';
                resultText.textContent = 'ì •ë‹µì…ë‹ˆë‹¤!';
                resultText.className = 'font-bold text-green-600';
            } else {
                resultDiv.className = 'p-4 rounded-lg bg-red-50 border border-red-200';
                resultIcon.textContent = 'âœ—';
                resultIcon.className = 'text-red-600';
                resultText.textContent = 'í‹€ë ¸ìŠµë‹ˆë‹¤!';
                resultText.className = 'font-bold text-red-600';
            }

            // ì •ë‹µ í‘œì‹œ
            document.getElementById('correctChinese').textContent = currentWord.chinese;
            document.getElementById('correctPinyin').textContent = currentWord.pinyin;
            document.getElementById('correctMeaning').textContent = currentWord.meaning;
            
            resultDiv.classList.remove('hidden');
            document.getElementById('checkBtn').classList.add('hidden');
            document.getElementById('nextBtn').classList.remove('hidden');
            
            // ì…ë ¥ ë¹„í™œì„±í™”
            document.getElementById('pinyinInput').disabled = true;
            document.getElementById('meaningInput').disabled = true;
            
            updateUI();
        }

        // ë‹¤ìŒ ë¬¸ì œ
        function nextQuestion() {
            const newUsedIndices = new Set([...usedIndices, shuffledIndices[currentIndex]]);
            
            if (newUsedIndices.size === countryData.length) {
                // í•œ ë°”í€´ ì™„ë£Œ, ìƒˆë¡œìš´ ë¼ìš´ë“œ ì‹œì‘
                const indices = Array.from({ length: countryData.length }, (_, i) => i);
                shuffledIndices = shuffleArray(indices);
                currentIndex = 0;
                usedIndices = new Set();
                round++;
            } else {
                usedIndices = newUsedIndices;
                currentIndex++;
            }

            // ì…ë ¥ ì´ˆê¸°í™”
            document.getElementById('pinyinInput').value = '';
            document.getElementById('meaningInput').value = '';
            document.getElementById('pinyinInput').disabled = false;
            document.getElementById('meaningInput').disabled = false;
            
            // ë²„íŠ¼ ìƒíƒœ ë³€ê²½
            document.getElementById('result').classList.add('hidden');
            document.getElementById('checkBtn').classList.remove('hidden');
            document.getElementById('nextBtn').classList.add('hidden');
            
            updateUI();
        }

        // ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ
        document.getElementById('playBtn').addEventListener('click', speakChinese);
        
        // ì—”í„°í‚¤ ì´ë²¤íŠ¸
        document.getElementById('pinyinInput').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                document.getElementById('meaningInput').focus();
            }
        });
        
        document.getElementById('meaningInput').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                if (!document.getElementById('checkBtn').classList.contains('hidden')) {
                    checkAnswer();
                }
            }
        });

        // ì •ë‹µ í™•ì¸ ë²„íŠ¼ í™œì„±í™”/ë¹„í™œì„±í™”
        function updateCheckButton() {
            const pinyin = document.getElementById('pinyinInput').value;
            const meaning = document.getElementById('meaningInput').value;
            const checkBtn = document.getElementById('checkBtn');
            
            if (pinyin && meaning) {
                checkBtn.disabled = false;
                checkBtn.classList.remove('opacity-50', 'cursor-not-allowed');
            } else {
                checkBtn.disabled = true;
                checkBtn.classList.add('opacity-50', 'cursor-not-allowed');
            }
        }

        document.getElementById('pinyinInput').addEventListener('input', updateCheckButton);
        document.getElementById('meaningInput').addEventListener('input', updateCheckButton);

        // ì´ˆê¸°í™” ì‹¤í–‰
        init();
        updateCheckButton();
    </script>
</body>
</html>